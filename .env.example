# pi-linear-service Environment Configuration
# Copy this file to .env and fill in the required values

# -----------------------------------------------------------------------------
# REQUIRED CONFIGURATION
# -----------------------------------------------------------------------------

# Linear API authentication key
# Get from: https://linear.app/settings/api
LINEAR_API_KEY=lin_api_your_api_key_here

# Linear user ID to filter issues by assignee
# Get from: Linear CLI (linear issue view) or Linear UI user settings
ASSIGNEE_ID=user_id_here

# -----------------------------------------------------------------------------
# OPTIONAL CONFIGURATION - Polling Behavior
# -----------------------------------------------------------------------------

# Polling interval in seconds (default: 300, minimum: 5)
# How often to check Linear API for assigned issues
POLL_INTERVAL_SEC=300

# Maximum number of issues to fetch per poll (default: 100, minimum: 1)
# If this limit is reached, a warning is logged about possible truncation
LINEAR_PAGE_LIMIT=100

# Comma-separated list of Linear issue states to consider "open" (default: Todo,In Progress)
# Only issues in these states will trigger tmux session creation
LINEAR_OPEN_STATES=Todo,In Progress

# -----------------------------------------------------------------------------
# OPTIONAL CONFIGURATION - tmux Session Management
# -----------------------------------------------------------------------------

# Prefix for tmux sessions created by this service (default: pi_project_)
# Sessions with this prefix are considered "owned" by this service for health checks
# Format: ${TMUX_PREFIX}${projectId}
TMUX_PREFIX=pi_project_

# Command template for sessions (default: pi -p "You are working on project: ${projectName} list issues and choose one to work on, if an issue is already in progress - continue")
# Available placeholders:
#   ${projectName}  - Name of the project from Linear
#   ${projectId}    - ID of the project (e.g., ABC-123)
#   ${sessionId}    - Full session name (e.g., pi_project_ABC-123)
#   ${issueCount}   - Number of qualifying issues in the project
# The command runs in non-interactive mode with -p flag, so pi processes the prompt and exits.
# This allows the service to process work items one at a time and create new sessions as needed.
SESSION_COMMAND_TEMPLATE=pi -p "You are working on project: ${projectName} list issues and choose one to work on, if an issue is already in progress - continue"

# -----------------------------------------------------------------------------
# OPTIONAL CONFIGURATION - Health & Recovery
# -----------------------------------------------------------------------------

# Health check mode (default: basic, allowed: none|basic)
# - none: No health checks performed
# - basic: Check if session has live panes; exited pane = unhealthy
SESSION_HEALTH_MODE=basic

# Kill unhealthy sessions (default: false)
# If true, unhealthy sessions owned by this service will be killed
# Safety: disabled by default to prevent unexpected session termination
SESSION_KILL_ON_UNHEALTHY=false

# Cooldown period in seconds before re-killing a session (default: 60, minimum: 0)
# Prevents kill/restart loops for sessions that fail to start properly
SESSION_RESTART_COOLDOWN_SEC=60

# -----------------------------------------------------------------------------
# OPTIONAL CONFIGURATION - Logging
# -----------------------------------------------------------------------------

# Log level (default: info, allowed: error|warn|info|debug)
# - error: Only errors
# - warn: Errors and warnings
# - info: Normal operational messages (default)
# - debug: Verbose output for troubleshooting
LOG_LEVEL=info
